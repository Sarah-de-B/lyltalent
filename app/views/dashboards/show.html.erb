<% if @user.role == "artiste"%>
  <%= month_calendar(attribute: :starts_at, events: @entertainments) do |date, entertainments|%>
    <% if entertainments.any? %>
      <%= link_to entertainment_path(entertainments.first), class: "calendar-accepted" do %>
        <%= date.day %>
      <% end %>
    <% else %>
      <%= date.day %>
    <% end %>
  <% end %>
<% else %>
  <%= cl_image_tag @user.photos.first.key, alt: @user.last_name, class: "event-image"%>
<% end %>
<div class="container-dashboard">

  <div class="artist-profile">
    <div class="artist-profile-photo-group">
        <%= cl_image_tag @user.photos.first.key, alt: @user.artist_name, class: "artist-profile-photo rounded-circle" %>
    </div>

    <h1 class="artist-profile-name"><%= @user.artist_name %></h1>
    <p class="artist-profile-bio"><%= @user.bio %></p>
  </div>

    <%# <h2>Mes propositions en attente</h2> %>

    <%# <h2>Mes candidatures en accepté</h2> %>

    <h2>Mes événements à venir</h2>

    <section class="splide" data-controller="carousel" aria-label="Splide Basic HTML Example">
      <div class="splide__track">
        <ul class="splide__list">
          <% if @user.role == "artiste" %>
            <% @applications.where(status: "Accepté").each do |application| %>
            <%= render "application_card", application: application, status_class: "application-card-status-accepted" %>
            <% end %>
            <% @applications.where(status: "Validé").each do |application| %>
            <%= render "application_card", application: application, status_class: "application-card-status-validate" %>
            <% end %>
          <% else %>
            <% @user.events.each do |event| %>
              <%= render "event_card", event: event %>
            <% end %>
          <% end %>
        </ul>
      </div>
    </section>

    <% if @applications.where(status: "Proposé").empty? %>
      <h2 class= "d-none">Proposition en attente de ma confirmation</h2>
    <% else %>
      <h2>Proposition en attente de ma confirmation</h2>

      <section class="splide" data-controller="carousel" aria-label="Splide Basic HTML Example">
        <div class="splide__track">
          <ul class="splide__list">
            <% @applications.where(status: "Proposé").each do |application| %>
            <%= render "application_card", application: application, status_class: "application-card-status-proposed" %>
            <% end %>
          </ul>
        </div>
      </section>
    <% end %>
    <%# <h2>Mes proposition validé</h2>

    <section class="splide" data-controller="carousel" aria-label="Splide Basic HTML Example">
      <div class="splide__track">
        <ul class="splide__list">
          <% @applications.where(status: "Validé").each do |application| %>
          <%# <%= render "application_card", application: application, status_class: "application-card-status-validate" %>
          <%# <% end %>
        <%# </ul>
      </div>
    </section>  %>

    <% if @applications.where(status: "En cours").empty? %>
      <h2 class="d-none">Mes candidatures en attente</h2>
      <p class="text-center">Candidate aux événements directement depuis la home page</p>
    <% else %>
      <h2>Mes candidatures en attente</h2>

      <section class="splide" data-controller="carousel" aria-label="Splide Basic HTML Example">
        <div class="splide__track">
          <ul class="splide__list">
            <% @applications.where(status: "En cours").each do |application| %>
            <%= render "application_card", application: application, status_class: "application-card-status-pending" %>
            <% end %>
          </ul>
        </div>
      </section>
    <% end %>





    <h2 id="epk-title">Mon EPK</h2>
    <%# <div class= "d-flex justify-content-center align-items-center"> %>
    <div class="flex-space-around-simple">
      <button class= "top-right-btn">
        <%= link_to edit_epk_path do %>
          Modifier
        <% end %>
      </button>
      <button class= "top-right-btn">
        <%= link_to epk_path do %>
          Voir
        <% end %>
      </button>
    </div>

    <div class= "d-flex justify-content-center align-items-center">
      <%= button_to "Deconnexion", destroy_user_session_path, method: :delete, class: "top-right-btn" %>
    </div>
</div>
